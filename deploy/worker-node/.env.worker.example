# -----------------------------
# Worker Identity & API
# -----------------------------
WORKER_CODE=worker-node-2
WORKER_NAME=Worker Node 2
WORKER_API_BASE_URL=http://worker-node-2.example.edu.vn:3000
WORKER_PUBLIC_PORT=3000
WORKER_CLUSTER_TOKEN=change-me
CONTROL_PLANE_API_BASE=https://sotvdi.umtoj.edu.vn/api
HEARTBEAT_INTERVAL_SEC=20

# -----------------------------
# Shared Security (MUST match control-plane)
# -----------------------------
JWT_SECRET=KYTHIUMTTECHGEN2026
GUAC_TOKEN_KEY=a7F3k9Q2mX8vL1pR6tN0cD5hJ4sWzY3u

# -----------------------------
# Database (central DB of control-plane)
# -----------------------------
DB_HOST=10.10.10.10
DB_PORT=5432
DB_USER=umt_user
DB_PASSWORD=change-me
DB_NAME=vdi_portal_db
TYPEORM_SYNCHRONIZE=false

# -----------------------------
# Exam VM Runtime
# -----------------------------
EXAM_VM_USERNAME=student
EXAM_VM_PASSWORD=123456
EXAM_BROWSER_URL=https://sot.umtoj.edu.vn
EXAM_BROWSER_AUTOSTART=true
EXAM_BROWSER_PREWARM=true
EXAM_IMAGE_NAME=sot-exam-linux:latest
EXAM_IMAGE_CONTEXT=./exam-linux
# FORCE_REBUILD_EXAM_IMAGE=true
EXAM_VM_MEMORY_MB=2048
EXAM_VM_CPUS=1.5
EXAM_VM_SHM_MB=512
# Outbound internet policy inside exam VM
EXAM_RESTRICT_INTERNET=true
EXAM_ALLOWED_DOMAINS=sot.umtoj.edu.vn
EXAM_ORIGIN_IP=203.210.213.198
# WAF/CD CIDRs (comma-separated)
EXAM_ALLOWED_CIDRS=103.90.220.0/22,103.151.240.0/23,103.161.22.0/23,103.162.92.0/23,103.183.108.0/23,42.1.71.0/28,42.1.110.0/28,160.19.158.0/23,42.1.76.128/28,1.55.145.0/24,42.114.75.0/24
# Optional extra exact IPs (comma-separated)
EXAM_ALLOWED_IPS=
# true: container fail if firewall cannot be applied
EXAM_FIREWALL_ENFORCE_STRICT=true
VDI_ALLOCATE_TIMEOUT_SEC=90
VDI_PREWARM_CONCURRENCY=5
VDI_PREWARM_MAX=200

# -----------------------------
# Worker capacity model
# -----------------------------
WORKER_RESERVED_CPUS=1
WORKER_RESERVED_MEMORY_MB=1024
WORKER_HEARTBEAT_TTL_SEC=120
WORKER_STICKY_EXAM_TTL_SEC=21600
CLUSTER_API_TIMEOUT_MS=15000
WORKER_ALLOCATE_RETRY_COUNT=3
WORKER_DISPATCH_CLEANUP_ENABLED=true
WORKER_DISPATCH_STALE_SEC=21600
WORKER_DISPATCH_SCAN_COUNT=200

# Optional override for compose project
# COMPOSE_PROJECT_NAME=vdi-worker-node-2
